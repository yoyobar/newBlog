---
title: '06. 방문자 집계 기능 만들기'
description: ''
image: '/img/2024-06-26-13-52-42.webp'
tags: [typescript,next.js,tailwindCSS]
date: 2024-07-02 13:56:38
update: 2024-06-26 13:56:38
---

## 개요

해당 블로그는 [Supabase](https://supabase.com/)를 통해
nonSQL 백엔드 서비스를 이용하여 댓글과 방문자집계를 구현 하였습니다. 
그 과정을 소개해보고자 합니다.

### Supabase 란?

![](/img/2024-06-27-11-04-10.webp)
> Supabase는 오픈소스 Firebase 대안입니다. 
> Postgres 데이터베이스, 인증, 인스턴드 API, Edge 기능, 실시간 구독, 스토리지 및 벡터 임베딩을 지원합니다.

20개 이상의 프레임워크와 원활하게 작동하면서, 간단하게 구축을 시도할 수 있습니다.


### Supabase를 왜 사용하는가?

프론트엔드 개발자로서 백엔드가 아예없이 프론트영역을 구축하는데에는 아무래도 한계가 있습니다. 
사용자의 요청에 따른 서버의 응답등이 아예없이 구현하려면 구현할 수 없는 부분도 존재합니다.

`supabase`는 가볍고 사용하기 쉬운 백엔드 서비스를 지원해줍니다.


### 가격적인 측면에서의 장점
![](/img/2024-06-27-11-02-27.webp)

요금도 중요합니다.
무료로 2개의 프로젝트를 지원하고, API요청에 제한이 없으며 무료사용자에게 상당히 큰 혜택을
제공 해줍니다. 사실 안 쓸 이유가 없습니다!

하지만 저희는 `supabase` 서비스를 사전에 설정하지 않았는데요.
이런 부분에서 약간 어려움을 느낄 수도 있지만, 직접 수동으로 적용해보겠습니다.


## Supabase 사전 세팅 (INIT)

우선 홈페이지에서 프로젝트를 생성하고, `Table Editor`에서 가볍게 테이블을 생성합니다. 

쿼리문으로 작성하거나, 직접 제작하시면됩니다. 
저는 쿼리문으로 작성해보겠습니다.

```sql
CREATE TABLE daily_visitors (
    id SERIAL PRIMARY KEY,
    visit_date DATE NOT NULL,
    visit_count INTEGER NOT NULL DEFAULT 0,
    ip_address VARCHAR(45) NOT NULL
);
```

간단한 일일 사용자를 기록하는 sql문을 `SQL Editor`에서 작성하고,  테이블에 등록합니다. 
등록된 테이블은 직접 확인해볼 수 있습니다.

이제 등록된 테이블을 다루기전에, `DB API`요청시 필요한
환경 변수 값을 설정해주어야 합니다.

![](/img/2024-06-27-11-13-31.webp)

환경변수는 Settings -> API에서 확인할 수 있습니다.

여기서 저희가 필요한 값은 `URL`과, `PUBLIC ANON KEY` 입니다.

![](/img/2024-06-27-11-21-39.webp)

이와 같이 환경변수 값을 설정합니다. 이 값은 노출되어서는 안됩니다. 물론 `next.js`에서 `PUBLIC` 속성을 주는경우 클라이언트/서버 양쪽에서 확인할 수 있는 문제가 있습니다만, `URL`과 `ANON KEY`는 민감한 정보는 아닙니다. 따라서 `PUBLIC` 환경변수로 사용해도 문제되지 않습니다.